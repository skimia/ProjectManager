{{module_var}}.controller('MainCtrl',['$rootScope','$scope','s-auth','Projects','$http',function($rootScope,$scope,auth,Projects,$http){
    $scope.projects = Projects.query();
    $scope.auth = {};
    var login =$('#login-holder');
        
    $scope.$on('event:auth-loginRequired', function() {
      login.show();
    });
    $scope.$on('event:auth-loginConfirmed', function() {
      login.hide();
    });
    $http.get('https://api.github.com/repos/skimia/ProjectManager/commits').success(function(data, status, headers, config) {
        $rootScope.commits = data;
    });
    $rootScope.getRev = function(){
        if($rootScope.commits != undefined)
            return $rootScope.commits[0].sha.substring(0,10);
    }
    $scope.login = function(){
        auth.authenticate($scope.auth.ident,$scope.auth.password);
    };
    $scope.showLogin = function(){
        $rootScope.$broadcast('event:auth-loginRequired');
    }
    $scope.hideLogin = function(){
        $('#login-holder').hide();
    }
    $scope.logout = function(){
        auth.logout();
    };
}]);